{% extends 'base.html' %}
{% load static %}
{% block main_block %}
<link rel="stylesheet" href="{% static 'css/appoinment.css' %}">

<!-- Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<!-- Flatpickr JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


<div class="container mt-5 pt-5">
    <div class="header">
        <h1>Book Your Appointment</h1>
    </div>
    
    <div class="content">
        
        
        <!-- Right Panel - Form -->
        <div class="right-panel ">
            <div class="form-container">
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}">Name</label>
                        {{ form.name }}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.age.id_for_label }}">Age</label>
                        {{ form.age }}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.email.id_for_label }}">Email</label>
                        {{ form.email }}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.age.id_for_label }}">Phone</label>
                        {{ form.phone }}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.goal.id_for_label }}">Your Goal</label>
                        {{ form.goal }}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.any_medical_history.id_for_label }}">Any Medical History?</label>
                        {{ form.any_medical_history }}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.medical_history_details.id_for_label }}">Medical History Details</label>
                        {{ form.medical_history_details }}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.price.id_for_label }}">Choose Package</label>
                        {{ form.price }}
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.slot.id_for_label }}" class="form-label">Select Date</label>
                        <!-- This input will trigger the calendar -->
                        <input type="text" id="date-picker" class="form-control" placeholder="Choose an available date">
                        
                        <!-- The real select dropdown is hidden -->
                        <div style="display: none;">
                            {{ form.slot }}
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Select Time:</label>
                        <div class="radio-group">
                            {% for radio in form.time %}
                                <div class="radio-item ">
                                    {{ radio.tag }}
                                    <label for="{{ radio.id_for_label }}" class="radio-label mt-2">{{ radio.choice_label }}</label>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-submit">Book Appointment</button>
                </form>
            </div>
        </div>
        <!-- Left Panel - Price and Appointment Details -->
        <div class="left-panel">
            
            <div class="row d-none d-sm-flex">
                {% for item in price_list %}
                <div class="col-md-4 mb-4 ">
                    <div class="card shadow-sm h-100">
                        <div class="card-body text-center">
                            <h5 class="card-title">{{ item.price_choise }}</h5>
                            <h6 class="card-subtitle mb-2 text-muted">£{{ item.price }}</h6>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="appointment-details">
                <h3>Appointment Details</h3>
                <div class="detail-item">
                    <div class="detail-icon">✓</div>
                    <div>20 - 45 minute consultation</div>
                </div>
                <div class="detail-item">
                    <div class="detail-icon">✓</div>
                    <div>Personalized treatment plan</div>
                </div>
                <div class="detail-item">
                    <div class="detail-icon">✓</div>
                    <div>Follow-up recommendations</div>
                </div>
                <div class="detail-item">
                    <div class="detail-icon">✓</div>
                    <div>Available in-person or online</div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const select = document.querySelector('select[name="slot"]');
        const datePickerInput = document.getElementById('date-picker');

        // Create an array of date options from the select dropdown
        const options = Array.from(select.options).map(opt => ({
            label: opt.text,
            value: opt.value
        }));

        const availableDates = options.map(opt => opt.label); // slot.date values

        flatpickr(datePickerInput, {
            dateFormat: "Y-m-d",
            enable: availableDates, // only allow selecting available dates
            onChange: function (selectedDates, dateStr) {
                // When user picks a date, set the corresponding option as selected
                const option = options.find(opt => opt.label === dateStr);
                if (option) {
                    select.value = option.value;
                }
            }
        });
    });
</script>


{% endblock %}
    

